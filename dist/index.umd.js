!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("rxjs"),require("rxjs/operators"),require("buffer"),require("crypto-js"),require("secp256k1")):"function"==typeof define&&define.amd?define(["rxjs","rxjs/operators","buffer","crypto-js","secp256k1"],e):(t||self).lnmessage=e(t.rxjs,t.operators,t.buffer,t.cryptoJs,t.secp256K1)}(this,function(t,e,r,n,i){function o(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var s=/*#__PURE__*/o(n),a=/*#__PURE__*/o(i);function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function f(){return f=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},f.apply(this,arguments)}function c(t,e){return t<<e|t>>>32-e}var d=r.Buffer.from("expand 32-byte k"),l=/*#__PURE__*/function(){function t(t,e){this.input=void 0,this.cachePos=void 0,this.buffer=void 0,this.output=void 0,this.input=new Uint32Array(16),this.input[0]=d.readUInt32LE(0),this.input[1]=d.readUInt32LE(4),this.input[2]=d.readUInt32LE(8),this.input[3]=d.readUInt32LE(12),this.input[4]=t.readUInt32LE(0),this.input[5]=t.readUInt32LE(4),this.input[6]=t.readUInt32LE(8),this.input[7]=t.readUInt32LE(12),this.input[8]=t.readUInt32LE(16),this.input[9]=t.readUInt32LE(20),this.input[10]=t.readUInt32LE(24),this.input[11]=t.readUInt32LE(28),this.input[12]=0,this.input[13]=e.readUInt32LE(0),this.input[14]=e.readUInt32LE(4),this.input[15]=e.readUInt32LE(8),this.cachePos=64,this.buffer=new Uint32Array(16),this.output=new r.Buffer(64)}var e=t.prototype;return e.quarterRound=function(t,e,r,n){var i=this.buffer;i[t]+=i[e],i[n]=c(i[n]^i[t],16),i[r]+=i[n],i[e]=c(i[e]^i[r],12),i[t]+=i[e],i[n]=c(i[n]^i[t],8),i[r]+=i[n],i[e]=c(i[e]^i[r],7)},e.makeBlock=function(t,e){for(var r=-1;++r<16;)this.buffer[r]=this.input[r];for(r=-1;++r<10;)this.quarterRound(0,4,8,12),this.quarterRound(1,5,9,13),this.quarterRound(2,6,10,14),this.quarterRound(3,7,11,15),this.quarterRound(0,5,10,15),this.quarterRound(1,6,11,12),this.quarterRound(2,7,8,13),this.quarterRound(3,4,9,14);for(r=-1;++r<16;)this.buffer[r]+=this.input[r],t.writeUInt32LE(this.buffer[r],e),e+=4;if(this.input[12]++,!this.input[12])throw new Error("counter is exausted")},e.getBytes=function(t){var e=0,n=new r.Buffer(t),i=64-this.cachePos;if(i){if(i>=t)return this.output.copy(n,0,this.cachePos,64),this.cachePos+=t,n;this.output.copy(n,0,this.cachePos,64),t-=i,e+=i,this.cachePos=64}for(;t>0;){if(t<=64)return this.makeBlock(this.output,0),this.output.copy(n,e,0,t),t<64&&(this.cachePos=t),n;this.makeBlock(n,e),t-=64,e+=64}throw new Error("something bad happended")},t}(),g=/*#__PURE__*/function(){function t(t){this.buffer=void 0,this.leftover=void 0,this.r=void 0,this.h=void 0,this.pad=void 0,this.finished=void 0,this.buffer=new r.Buffer(16),this.leftover=0,this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.finished=0;var e,n=new Uint16Array(8);for(e=8;e--;)n[e]=t.readUInt16LE(2*e);for(this.r[0]=8191&n[0],this.r[1]=8191&(n[0]>>>13|n[1]<<3),this.r[2]=7939&(n[1]>>>10|n[2]<<6),this.r[3]=8191&(n[2]>>>7|n[3]<<9),this.r[4]=255&(n[3]>>>4|n[4]<<12),this.r[5]=n[4]>>>1&8190,this.r[6]=8191&(n[4]>>>14|n[5]<<2),this.r[7]=8065&(n[5]>>>11|n[6]<<5),this.r[8]=8191&(n[6]>>>8|n[7]<<8),this.r[9]=n[7]>>>5&127,e=8;e--;)this.h[e]=0,this.pad[e]=t.readUInt16LE(16+2*e);this.h[8]=0,this.h[9]=0,this.leftover=0,this.finished=0}var e=t.prototype;return e.blocks=function(t,e,r){for(var n=this.finished?0:2048,i=new Uint16Array(8),o=new Uint32Array(10),s=0,a=0,h=0;r>=16;){for(a=8;a--;)i[a]=t.readUInt16LE(2*a+e);for(this.h[0]+=8191&i[0],this.h[1]+=8191&(i[0]>>>13|i[1]<<3),this.h[2]+=8191&(i[1]>>>10|i[2]<<6),this.h[3]+=8191&(i[2]>>>7|i[3]<<9),this.h[4]+=8191&(i[3]>>>4|i[4]<<12),this.h[5]+=i[4]>>>1&8191,this.h[6]+=8191&(i[4]>>>14|i[5]<<2),this.h[7]+=8191&(i[5]>>>11|i[6]<<5),this.h[8]+=8191&(i[6]>>>8|i[7]<<8),this.h[9]+=i[7]>>>5|n,a=0,s=0;a<10;a++){for(o[a]=s,h=0;h<10;h++)o[a]+=(4294967295&this.h[h])*(h<=a?this.r[a-h]:5*this.r[a+10-h]),4===h&&(s=o[a]>>>13,o[a]&=8191);s+=o[a]>>>13,o[a]&=8191}for(s=(s<<2)+s,o[0]=8191&(s+=o[0]),o[1]+=s>>>=13,a=10;a--;)this.h[a]=o[a];e+=16,r-=16}},e.update=function(t){var e=t.length,r=0,n=0,i=0;if(this.leftover){for((r=16-this.leftover)>e&&(r=e),n=r;n--;)this.buffer[this.leftover+n]=t[n+i];if(e-=r,i+=r,this.leftover+=r,this.leftover<16)return this;this.blocks(this.buffer,0,16),this.leftover=0}if(e>=16&&(this.blocks(t,i,r=-16&e),i+=r,e-=r),e){for(n=e;n--;)this.buffer[this.leftover+n]=t[n+i];this.leftover+=e}return this},e.finish=function(){var t=new r.Buffer(16),e=new Uint16Array(10),n=0,i=0,o=0,s=0;if(this.leftover){for(s=this.leftover,this.buffer[s++]=1;s<16;s++)this.buffer[s]=0;this.finished=1,this.blocks(this.buffer,0,16)}for(n=this.h[1]>>>13,this.h[1]&=8191,s=2;s<10;s++)this.h[s]+=n,n=this.h[s]>>>13,this.h[s]&=8191;for(this.h[0]+=5*n,n=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=n,n=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=n,e[0]=this.h[0]+5,n=e[0]>>>13,e[0]&=8191,s=1;s<10;s++)e[s]=this.h[s]+n,n=e[s]>>>13,e[s]&=8191;for(e[9]-=8192,i=(e[9]>>>15)-1,s=10;s--;)e[s]&=i;for(i=~i,s=10;s--;)this.h[s]=this.h[s]&i|e[s];for(this.h[0]=this.h[0]|this.h[1]<<13,this.h[1]=this.h[1]>>3|this.h[2]<<10,this.h[2]=this.h[2]>>6|this.h[3]<<7,this.h[3]=this.h[3]>>9|this.h[4]<<4,this.h[4]=this.h[4]>>12|this.h[5]<<1|this.h[6]<<14,this.h[5]=this.h[6]>>2|this.h[7]<<11,this.h[6]=this.h[7]>>5|this.h[8]<<8,this.h[7]=this.h[8]>>8|this.h[9]<<5,this.h[0]=o=(4294967295&this.h[0])+this.pad[0],s=1;s<8;s++)this.h[s]=o=(4294967295&this.h[s])+this.pad[s]+(o>>>16);for(s=8;s--;)t.writeUInt16LE(this.h[s],2*s),this.pad[s]=0;for(s=10;s--;)this.h[s]=0,this.r[s]=0;return t},t}(),v=/*#__PURE__*/function(){function t(t,e,r){void 0===r&&(r=!1),this.alen=void 0,this.clen=void 0,this.chacha=void 0,this.poly=void 0,this.tag=void 0,this._decrypt=void 0,this._hasData=void 0,this.alen=0,this.clen=0,this.chacha=new l(t,e),this.poly=new g(this.chacha.getBytes(64)),this.tag=null,this._decrypt=r,this._hasData=!1}var e=t.prototype;return e.setAAD=function(t){if(this._hasData)throw new Error("Attempting to set AAD in unsupported state");this.alen=t.length,this.poly.update(t);var e=new r.Buffer(p(this.alen));e.length&&(e.fill(0),this.poly.update(e))},e.update=function(t,e,n){"string"==typeof t&&(t=r.Buffer.from(t,e));var i=this._update(t)||r.Buffer.from("");return n?i.toString(n):i},e.final=function(t){var e=this._final()||r.Buffer.from("");return t?e.toString(t):e},e._update=function(t){this._hasData||(this._hasData=!0);var e=t.length;if(e){this.clen+=e;for(var r=this.chacha.getBytes(e),n=-1;++n<e;)r[n]^=t[n];return this.poly.update(this._decrypt?t:r),r}},e._final=function(){if(this._decrypt&&!this.tag)throw new Error("Unsupported state or unable to authenticate data");var t=new r.Buffer(p(this.clen));t.length&&(t.fill(0),this.poly.update(t));var e=new r.Buffer(16);e.fill(0),e.writeUInt32LE(this.alen,0),e.writeUInt32LE(this.clen,8);var n=this.poly.update(e).finish();if(this._decrypt){if(function(t,e){var r=0;t.length!==e.length&&r++;for(var n=Math.min(t.length,e.length),i=-1;++i<n;)r+=t[i]^e[i];return r}(n,this.tag))throw new Error("Unsupported state or unable to authenticate data")}else this.tag=n;return n},e.getAuthTag=function(){return this._decrypt||null===this.tag?new r.Buffer(""):this.tag},e.setAuthTag=function(t){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this.tag=t},t}();function p(t){var e=t%16;return e?16-e:0}var m=function(t){try{return Promise.resolve(window.crypto.subtle.digest("SHA-256",t)).then(function(t){return r.Buffer.from(t)})}catch(t){return Promise.reject(t)}};function _(t,e){return r.Buffer.from(a.default.ecdh(t,e))}function B(t,e){var n=s.default.HmacSHA256(s.default.enc.Hex.parse(e.toString("hex")),s.default.enc.Hex.parse(t.toString("hex")));return r.Buffer.from(s.default.enc.Hex.stringify(n),"hex")}function y(t,e,n,i){void 0===n&&(n=r.Buffer.alloc(0)),void 0===i&&(i=r.Buffer.alloc(0));var o=B(n,t),s=Math.ceil(e/o.byteLength);if(s>255)throw new Error("Output length exceeds maximum");for(var a=[r.Buffer.alloc(0)],h=1;h<=s;h++){var u=a[a.length-1],f=r.Buffer.from([h]);a.push(B(o,r.Buffer.concat([u,i,f])))}return r.Buffer.concat(a.slice(1)).subarray(0,e)}function w(t,e){return void 0===e&&(e=!0),r.Buffer.from(a.default.publicKeyCreate(t,e))}function I(t,e,n,i){var o=new v(t,e);o.setAAD(n);var s=o.update(i);o.final&&o.final();var a=o.getAuthTag();return r.Buffer.concat([s,a])}function b(t,e,n,i){var o=new v(t,e,!0);if(o.setAAD(n),16===i.length)return o.setAuthTag(i),o.final();if(i.length>16){var s=i.subarray(i.length-16),a=i.subarray(0,i.length-16);o.setAuthTag(s);var h=o.update(a),u=o.final();return r.Buffer.concat([h,u])}}function E(){var t;do{var e=r.Buffer.allocUnsafe(32);t=window.crypto.getRandomValues(e)}while(!R(t));return t.toString("hex")}function R(t){return a.default.privateKeyVerify("string"==typeof t?r.Buffer.from(t,"hex"):t)}var U,k,P,A=/*#__PURE__*/function(){function t(t){var e=t.ls,n=t.es;this.protocolName=r.Buffer.from("Noise_XK_secp256k1_ChaChaPoly_SHA256"),this.prologue=r.Buffer.from("lightning"),this.ls=void 0,this.lpk=void 0,this.es=void 0,this.epk=void 0,this.rpk=void 0,this.repk=void 0,this.h=void 0,this.ck=void 0,this.rk=void 0,this.sk=void 0,this.sn=void 0,this.rn=void 0,this.tempK1=void 0,this.tempK2=void 0,this.tempK3=void 0,this.ls=e,this.lpk=w(e),this.es=n,this.epk=w(n)}var e=t.prototype;return e.initiatorAct1=function(t){try{var e=this;return e.rpk=t,Promise.resolve(e._initialize(e.rpk)).then(function(){return Promise.resolve(m(r.Buffer.concat([e.h,e.epk]))).then(function(t){e.h=t;var n=y(_(e.rpk,e.es),64,e.ck);e.ck=n.subarray(0,32),e.tempK1=n.subarray(32);var i=I(e.tempK1,r.Buffer.alloc(12),e.h,r.Buffer.alloc(0));return Promise.resolve(m(r.Buffer.concat([e.h,i]))).then(function(t){return e.h=t,r.Buffer.concat([r.Buffer.alloc(1),e.epk,i])})})})}catch(t){return Promise.reject(t)}},e.initiatorAct2=function(t){try{var e=this;if(50!==t.length)throw new Error("ACT2_READ_FAILED");var n=t.subarray(0,1)[0],i=t.subarray(1,34),o=t.subarray(34);if(e.repk=i,0!==n)throw new Error("ACT2_BAD_VERSION");return Promise.resolve(m(r.Buffer.concat([e.h,e.repk]))).then(function(t){e.h=t;var n=y(_(e.repk,e.es),64,e.ck);return e.ck=n.subarray(0,32),e.tempK2=n.subarray(32),b(e.tempK2,r.Buffer.alloc(12),e.h,o),Promise.resolve(m(r.Buffer.concat([e.h,o]))).then(function(t){e.h=t})})}catch(t){return Promise.reject(t)}},e.initiatorAct3=function(){try{var t=this,e=I(t.tempK2,r.Buffer.from([0,0,0,0,1,0,0,0,0,0,0,0]),t.h,t.lpk);return Promise.resolve(m(r.Buffer.concat([t.h,e]))).then(function(n){t.h=n;var i=y(_(t.repk,t.ls),64,t.ck);t.ck=i.subarray(0,32),t.tempK3=i.subarray(32);var o=I(t.tempK3,r.Buffer.alloc(12),t.h,r.Buffer.alloc(0)),s=y(r.Buffer.alloc(0),64,t.ck);return t.rk=s.subarray(32),t.sk=s.subarray(0,32),t.sn=r.Buffer.alloc(12),t.rn=r.Buffer.alloc(12),r.Buffer.concat([r.Buffer.alloc(1),e,o])})}catch(t){return Promise.reject(t)}},e.receiveAct1=function(t){try{var e=this;return Promise.resolve(e._initialize(e.lpk)).then(function(){if(50!==t.length)throw new Error("ACT1_READ_FAILED");var n=t.subarray(0,1)[0],i=t.subarray(1,34),o=t.subarray(34);if(e.repk=i,0!==n)throw new Error("ACT1_BAD_VERSION");return Promise.resolve(m(r.Buffer.concat([e.h,i]))).then(function(t){e.h=t;var n=y(_(i,e.ls),64,e.ck);return e.ck=n.subarray(0,32),e.tempK1=n.subarray(32),b(e.tempK1,r.Buffer.alloc(12),e.h,o),Promise.resolve(m(r.Buffer.concat([e.h,o]))).then(function(t){e.h=t})})})}catch(t){return Promise.reject(t)}},e.recieveAct2=function(){try{var t=this;return Promise.resolve(m(r.Buffer.concat([t.h,t.epk]))).then(function(e){t.h=e;var n=y(_(t.repk,t.es),64,t.ck);t.ck=n.subarray(0,32),t.tempK2=n.subarray(32);var i=I(t.tempK2,r.Buffer.alloc(12),t.h,r.Buffer.alloc(0));return Promise.resolve(m(r.Buffer.concat([t.h,i]))).then(function(e){return t.h=e,r.Buffer.concat([r.Buffer.alloc(1),t.epk,i])})})}catch(t){return Promise.reject(t)}},e.receiveAct3=function(t){try{var e=this;if(66!==t.length)throw new Error("ACT3_READ_FAILED");var n=t.subarray(0,1)[0],i=t.subarray(1,50),o=t.subarray(50);if(0!==n)throw new Error("ACT3_BAD_VERSION");var s=b(e.tempK2,r.Buffer.from("000000000100000000000000","hex"),e.h,i);return e.rpk=s,Promise.resolve(m(r.Buffer.concat([e.h,i]))).then(function(t){e.h=t;var n=y(_(e.rpk,e.es),64,e.ck);e.ck=n.subarray(0,32),e.tempK3=n.subarray(32),b(e.tempK3,r.Buffer.alloc(12),e.h,o);var i=y(r.Buffer.alloc(0),64,e.ck);e.rk=i.subarray(0,32),e.sk=i.subarray(32),e.rn=r.Buffer.alloc(12),e.sn=r.Buffer.alloc(12)})}catch(t){return Promise.reject(t)}},e.encryptMessage=function(t){try{var e=this,n=r.Buffer.alloc(2);n.writeUInt16BE(t.length,0);var i=I(e.sk,e.sn,r.Buffer.alloc(0),n);e._incrementSendingNonce()>=1e3&&e._rotateSendingKeys();var o=I(e.sk,e.sn,r.Buffer.alloc(0),t);return e._incrementSendingNonce()>=1e3&&e._rotateSendingKeys(),Promise.resolve(r.Buffer.concat([i,o]))}catch(t){return Promise.reject(t)}},e.decryptLength=function(t){try{var e=this,n=b(e.rk,e.rn,r.Buffer.alloc(0),t);return e._incrementRecievingNonce()>=1e3&&e._rotateRecievingKeys(),Promise.resolve(n.readUInt16BE(0))}catch(t){return Promise.reject(t)}},e.decryptMessage=function(t){try{var e=this,n=b(e.rk,e.rn,r.Buffer.alloc(0),t);return e._incrementRecievingNonce()>=1e3&&e._rotateRecievingKeys(),Promise.resolve(n)}catch(t){return Promise.reject(t)}},e._initialize=function(t){try{var e=this;return Promise.resolve(m(r.Buffer.from(e.protocolName))).then(function(n){return e.h=n,e.ck=e.h,Promise.resolve(m(r.Buffer.concat([e.h,e.prologue]))).then(function(n){return e.h=n,Promise.resolve(m(r.Buffer.concat([e.h,t]))).then(function(t){e.h=t})})})}catch(t){return Promise.reject(t)}},e._incrementSendingNonce=function(){var t=this.sn.readUInt16LE(4)+1;return this.sn.writeUInt16LE(t,4),t},e._incrementRecievingNonce=function(){var t=this.rn.readUInt16LE(4)+1;return this.rn.writeUInt16LE(t,4),t},e._rotateSendingKeys=function(){var t=y(this.sk,64,this.ck);this.sk=t.subarray(32),this.ck=t.subarray(0,32),this.sn=r.Buffer.alloc(12)},e._rotateRecievingKeys=function(){var t=y(this.rk,64,this.ck);this.rk=t.subarray(32),this.ck=t.subarray(0,32),this.rn=r.Buffer.alloc(12)},t}(),S=/*#__PURE__*/function(){function t(t){this._buffer=void 0,this._position=void 0,this._lastReadBytes=void 0,this._buffer=t,this._position=0,this._lastReadBytes=0}t.bigSizeBytes=function(t){return t<BigInt(253)?1:t<BigInt(65536)?3:t<BigInt(4294967296)?5:9};var e=t.prototype;return e.readUInt8=function(){return this._readStandard(this.readUInt8.name,1)},e.readUInt16LE=function(){return this._readStandard(this.readUInt16LE.name,2)},e.readUInt16BE=function(){return this._readStandard(this.readUInt16BE.name,2)},e.readUInt32LE=function(){return this._readStandard(this.readUInt32LE.name,4)},e.readUInt32BE=function(){return this._readStandard(this.readUInt32BE.name,4)},e.readUInt64BE=function(){return BigInt("0x"+this.readBytes(8).toString("hex"))},e.readUInt64LE=function(){return BigInt("0x"+this.readBytes(8).reverse().toString("hex"))},e.readVarUint=function(){var t=this.readUInt8();if(t<253)return this._lastReadBytes=1,BigInt(t);switch(t){case 253:return this._lastReadBytes=3,BigInt(this.readUInt16LE());case 254:return this._lastReadBytes=5,BigInt(this.readUInt32LE());case 255:return this._lastReadBytes=9,this.readUInt64LE()}},e.readBigSize=function(){var t=this.readUInt8();if(t<253)return this._lastReadBytes=1,BigInt(t);switch(t){case 253:this._lastReadBytes=3;var e=this.readUInt16BE();if(e<253)throw new Error("decoded varint is not canonical");return BigInt(e);case 254:this._lastReadBytes=5;var r=this.readUInt32BE();if(r<65536)throw new Error("decoded varint is not canonical");return BigInt(r);case 255:this._lastReadBytes=9;var n=this.readUInt64BE();if(n<BigInt(4294967296))throw new Error("decoded varint is not canonical");return n;default:throw new Error("Unrecognised size: "+t+" when trying to read BigSize")}},e.readBytes=function(t){if(0===t)return this._lastReadBytes=0,r.Buffer.alloc(0);if("number"==typeof t&&t>0){if(this._position+t>this._buffer.length)throw new RangeError("Index out of range");var e=this._buffer.subarray(this._position,this._position+t),n=r.Buffer.alloc(e.length,e);return this._position+=t,this._lastReadBytes=t,n}if(this._position===this._buffer.length)return this._lastReadBytes=0,r.Buffer.alloc(0);var i=this._buffer.subarray(this._position),o=r.Buffer.alloc(i.length,i);return this._position=this._buffer.length,this._lastReadBytes=o.length,o},e.peakBytes=function(t){if(0===t)return r.Buffer.alloc(0);if("number"==typeof t&&t>0){if(this._position+t>this._buffer.length)throw new RangeError("Index out of range");var e=this._buffer.subarray(this._position,this._position+t);return r.Buffer.alloc(e.length,e)}if(this._position===this._buffer.length)throw new RangeError("Index out of range");var n=this._buffer.subarray(this._position);return r.Buffer.alloc(n.length,n)},e.readTUInt16=function(){var t=Math.min(2,this._buffer.length-this._position);if(0===t)return 0;var e=this._buffer.readUIntBE(this._position,t);return this._assertMinimalTUInt(BigInt(e),t),this._position+=t,e},e.readTUInt32=function(){var t=Math.min(4,this._buffer.length-this._position);if(0===t)return 0;var e=this._buffer.readUIntBE(this._position,t);return this._assertMinimalTUInt(BigInt(e),t),this._position+=t,e},e.readTUInt64=function(){var t=Math.min(8,this._buffer.length-this._position);if(0===t)return BigInt(0);var e=this._buffer.subarray(this._position,this._position+t).toString("hex")||"0",r=BigInt("0x"+e);return this._assertMinimalTUInt(r,t),this._position+=t,r},e._readStandard=function(t,e){if(this._position+e>this._buffer.length)throw new RangeError("Index out of range");var r=this._buffer[t](this._position);return this._position+=e,this._lastReadBytes=e,r},e._assertMinimalTUInt=function(t,e){for(var r=0;r<9;r++)if(t<BigInt("0x1"+"".padStart(2*r,"0"))&&e!==r)throw new Error("TUInt not minimal")},u(t,[{key:"position",get:function(){return this._position},set:function(t){this._position=t}},{key:"eof",get:function(){return this._position===this._buffer.length}},{key:"buffer",get:function(){return this._buffer}},{key:"lastReadBytes",get:function(){return this._lastReadBytes}}]),t}(),L=/*#__PURE__*/function(){function t(t){this._position=void 0,this._fixed=void 0,this._buffer=void 0,this._position=0,this._fixed=!!t,this._buffer=t||r.Buffer.alloc(0)}var e=t.prototype;return e.toBuffer=function(){return this._fixed?this._buffer:this._buffer.subarray(0,this._position)},e.writeUInt8=function(t){this._writeStandard(this.writeUInt8.name,t,1)},e.writeUInt16LE=function(t){this._writeStandard(this.writeUInt16LE.name,t,2)},e.writeUInt16BE=function(t){this._writeStandard(this.writeUInt16BE.name,t,2)},e.writeUInt32LE=function(t){this._writeStandard(this.writeUInt32LE.name,t,4)},e.writeUInt32BE=function(t){this._writeStandard(this.writeUInt32BE.name,t,4)},e.writeUInt64LE=function(t){var e=BigInt(t);if(e<0||e>=Math.pow(BigInt(2),BigInt(64)))throw new RangeError('The value of "value" is out of range. It must be >= 0 and <= 18446744073709551615. Received '+t.toString());var n=r.Buffer.from(e.toString(16).padStart(16,"0"),"hex");this.writeBytes(n.reverse())},e.writeUInt64BE=function(t){var e=BigInt(t);if(e<0||e>=Math.pow(BigInt(2),BigInt(64)))throw new RangeError('The value of "value" is out of range. It must be >= 0 and <= 18446744073709551615. Received '+t.toString());var n=r.Buffer.from(e.toString(16).padStart(16,"0"),"hex");this.writeBytes(n)},e.writeBytes=function(t){t&&t.length&&(this._expand(t.length),t.copy(this._buffer,this._position),this._position+=t.length)},e.writeVarInt=function(t){var e=BigInt(t);e<BigInt(253)?this.writeUInt8(Number(e)):e<BigInt(65536)?(this.writeUInt8(253),this.writeUInt16LE(Number(e))):e<BigInt(4294967296)?(this.writeUInt8(254),this.writeUInt32LE(Number(e))):(this.writeUInt8(255),this.writeUInt64LE(e))},e.writeBigSize=function(t){var e=BigInt(t);e<BigInt(253)?this.writeUInt8(Number(e)):e<BigInt(65536)?(this.writeUInt8(253),this.writeUInt16BE(Number(e))):e<BigInt(4294967296)?(this.writeUInt8(254),this.writeUInt32BE(Number(e))):(this.writeUInt8(255),this.writeUInt64BE(e))},e.writeTUInt16=function(t){if(0!==t){var e=t>255?2:1;this._expand(e),this._buffer.writeUIntBE(t,this._position,e),this._position+=e}},e.writeTUInt32=function(t){if(0!==t){var e=t>16777215?4:t>65535?3:t>255?2:1;this._expand(e),this._buffer.writeUIntBE(t,this._position,e),this._position+=e}},e.writeTUInt64=function(t){if(t!==BigInt(0)){var e=t.toString(16);e.length%2==1&&(e="0"+e);var n=r.Buffer.from(e,"hex");this.writeBytes(n)}},e._expand=function(t){var e=this._position+t;if(this._fixed&&e>this._buffer.length)throw new RangeError("Out of range");if(this._buffer.length<e){var n=1<<Math.ceil(Math.log2(e)),i=r.Buffer.alloc(n);this._buffer.copy(i),this._buffer=i}},e._writeStandard=function(t,e,r){this._expand(r),this._buffer[t](e,this._position),this._position+=r},u(t,[{key:"size",get:function(){return this._position}}]),t}(),N=/*#__PURE__*/function(){function t(t){this.value=void 0,this.value=t||BigInt(0)}t.fromNumber=function(e){return new t(BigInt(e))},t.fromBuffer=function(e){return 0===e.length?new t:new t(BigInt("0x"+e.toString("hex")))};var e=t.prototype;return e.isSet=function(t){return(this.value&BigInt(1)<<BigInt(t))>BigInt(0)},e.set=function(t){this.value|=BigInt(1)<<BigInt(t)},e.unset=function(t){this.value&=~(this.value&BigInt(1)<<BigInt(t))},e.toggle=function(t){this.value^=BigInt(1)<<BigInt(t)},e.flags=function(){for(var t=[],e=0,r=1n;r<this.value;)this.value&r&&t.push(e),e+=1,r<<=1n;return t},e.msb=function(){for(var t=this.value,e=0;t>1;)t>>=1n,e+=1;return e},e.and=function(e){return new t(this.value&e.value)},e.or=function(e){return new t(this.value|e.value)},e.xor=function(e){return new t(this.value^e.value)},e.toBigInt=function(){return this.value},e.toNumber=function(){return Number(this.value)},e.toBuffer=function(){return this.value===BigInt(0)?r.Buffer.alloc(0):(e=function(t){for(var e=0;t>BigInt(0);)e+=1,t/=BigInt(Math.pow(2,8));return e}(t=this.value),r.Buffer.from(t.toString(16).padStart(2*e,"0"),"hex"));var t,e},t}();!function(t){t[t.Init=16]="Init",t[t.Error=17]="Error",t[t.Ping=18]="Ping",t[t.Pong=19]="Pong",t[t.OpenChannel=32]="OpenChannel",t[t.AcceptChannel=33]="AcceptChannel",t[t.FundingCreated=34]="FundingCreated",t[t.FundingSigned=35]="FundingSigned",t[t.FundingLocked=36]="FundingLocked",t[t.Shutdown=38]="Shutdown",t[t.ClosingSigned=39]="ClosingSigned",t[t.ChannelAnnouncement=256]="ChannelAnnouncement",t[t.NodeAnnouncement=257]="NodeAnnouncement",t[t.ChannelUpdate=258]="ChannelUpdate",t[t.AnnouncementSignatures=259]="AnnouncementSignatures",t[t.QueryShortChannelIds=261]="QueryShortChannelIds",t[t.ReplyShortChannelIdsEnd=262]="ReplyShortChannelIdsEnd",t[t.QueryChannelRange=263]="QueryChannelRange",t[t.ReplyChannelRange=264]="ReplyChannelRange",t[t.GossipTimestampFilter=265]="GossipTimestampFilter",t[t.CommandoRequest=19535]="CommandoRequest",t[t.CommandoResponseContinues=22859]="CommandoResponseContinues",t[t.CommandoResponse=22861]="CommandoResponse"}(U||(U={})),function(t){t[t.INITIATOR_INITIATING=0]="INITIATOR_INITIATING",t[t.AWAITING_INITIATOR=1]="AWAITING_INITIATOR",t[t.AWAITING_RESPONDER_REPLY=2]="AWAITING_RESPONDER_REPLY",t[t.AWAITING_INITIATOR_REPLY=3]="AWAITING_INITIATOR_REPLY",t[t.READY=100]="READY"}(k||(k={})),function(t){t[t.READY_FOR_LEN=2]="READY_FOR_LEN",t[t.READY_FOR_BODY=3]="READY_FOR_BODY",t[t.BLOCKED=4]="BLOCKED"}(P||(P={}));var C=/*#__PURE__*/function(){function t(){this.type=U.Init,this.features=new N,this.chainHashes=[]}return t.deserialize=function(e){var r=new t,n=new S(e);n.readUInt16BE();var i=n.readUInt16BE(),o=N.fromBuffer(n.readBytes(i)),s=n.readUInt16BE(),a=N.fromBuffer(n.readBytes(s));return r.features=(new N).or(o).or(a),function(t,e){for(var r=BigInt(-1);!t.eof;)try{var n=t.readBigSize(),i=t.readBigSize(),o=t.readBytes(Number(i)),s=new S(o);if(n<=r)throw new Error("Invalid TLV stream");var a=n%BigInt(2)===BigInt(0),h=e(n,s);if(!h&&a)throw new Error("Unknown even type");if(h&&!s.eof)throw new Error("Non-canonical length");r=n}catch(t){}}(n,function(t,e){if(t===BigInt(1)){for(;!e.eof;){var n=e.readBytes(32);r.chainHashes.push(n)}return!0}return!1}),r},t.prototype.serialize=function(){var t=new L;t.writeUInt16BE(this.type),t.writeUInt16BE(0);var e=r.Buffer.from([0,0,0,0,0,0,0,0]);return t.writeUInt16BE(e.length),t.writeBytes(e),this.chainHashes.length&&(t.writeBigSize(1),t.writeBigSize(32*this.chainHashes.length),t.writeBytes(r.Buffer.concat(this.chainHashes))),t.toBuffer()},t}(),T=/*#__PURE__*/function(){function t(){this.type=U.Ping,this.numPongBytes=1,this.ignored=r.Buffer.alloc(0)}return t.deserialize=function(e){var r=new S(e);r.readUInt16BE();var n=new t;n.numPongBytes=r.readUInt16BE();var i=r.readUInt16BE();return n.ignored=r.readBytes(i),n},t.prototype.serialize=function(){var t=new L(r.Buffer.alloc(6+this.ignored.length));return t.writeUInt16BE(this.type),t.writeUInt16BE(this.numPongBytes),t.writeUInt16BE(this.ignored.length),t.writeBytes(this.ignored),t.toBuffer()},u(t,[{key:"triggersReply",get:function(){return this.numPongBytes<65532}}]),t}(),x=/*#__PURE__*/function(){function t(t){void 0===t&&(t=0),this.type=U.Pong,this.ignored=void 0,this.ignored=r.Buffer.alloc(t)}return t.deserialize=function(e){var r=new t,n=new S(e);n.readUInt16BE();var i=n.readUInt16BE();return r.ignored=n.readBytes(i),r},t.prototype.serialize=function(){var t=new L(r.Buffer.alloc(+this.ignored.length+4));return t.writeUInt16BE(this.type),t.writeUInt16BE(this.ignored.length),t.writeBytes(this.ignored),t.toBuffer()},t}(),M=/*#__PURE__*/function(){function t(){this.type=U.CommandoResponse,this.id=void 0,this.response=void 0}return t.deserialize=function(e){var r=new t,n=new S(e);n.readUInt16BE(),r.id=n.readBytes(8).toString("hex");var i=n.readBytes(e.byteLength-26).toString();try{r.response=JSON.parse(i)}catch(t){r.response={jsonrpc:"2.0",id:null,error:{code:1,message:"Could not parse json response"}}}return r},t}();function O(t,e,r){if(!t.s){if(r instanceof D){if(!r.s)return void(r.o=O.bind(null,t,e));1&e&&(e=r.s),r=r.v}if(r&&r.then)return void r.then(O.bind(null,t,e),O.bind(null,t,2));t.s=e,t.v=r;var n=t.o;n&&n(t)}}var D=/*#__PURE__*/function(){function t(){}return t.prototype.then=function(e,r){var n=new t,i=this.s;if(i){var o=1&i?e:r;if(o){try{O(n,1,o(this.v))}catch(t){O(n,2,t)}return n}return this}return this.o=function(t){try{var i=t.v;1&t.s?O(n,1,e?e(i):i):r?O(n,1,r(i)):O(n,2,i)}catch(t){O(n,2,t)}},n},t}();function j(t,e){var r,n=-1;t:{for(var i=0;i<e.length;i++){var o=e[i][0];if(o){var s=o();if(s&&s.then)break t;if(s===t){n=i;break}}else n=i}if(-1!==n){do{for(var a=e[n][1];!a;)n++,a=e[n][1];var h=a();if(h&&h.then){r=!0;break t}var u=e[n][2];n++}while(u&&!u());return h}}var f=new D,c=O.bind(null,f,2);return(r?h.then(d):s.then(function r(s){for(;;){if(s===t){n=i;break}if(++i===e.length){if(-1!==n)break;return void O(f,1,h)}if(o=e[i][0]){if((s=o())&&s.then)return void s.then(r).then(void 0,c)}else n=i}do{for(var a=e[n][1];!a;)n++,a=e[n][1];var h=a();if(h&&h.then)return void h.then(d).then(void 0,c);var u=e[n][2];n++}while(u&&!u());O(f,1,h)})).then(void 0,c),f;function d(t){for(;;){var r=e[n][2];if(!r||r())break;n++;for(var i=e[n][1];!i;)n++,i=e[n][1];if((t=i())&&t.then)return void t.then(d).then(void 0,c)}O(f,1,t)}}function K(t){return t instanceof D&&1&t.s}function z(t,e){try{var r=t()}catch(t){return e(t)}return r&&r.then?r.then(void 0,e):r}/*#__PURE__*/
return function(){function n(n){var i=this;this.noise=void 0,this.remoteNodePublicKey=void 0,this.publicKey=void 0,this.privateKey=void 0,this.wsUrl=void 0,this.socket=void 0,this.connected$=void 0,this.connecting=void 0,this.decryptedMsgs$=void 0,this.commandoMsgs$=void 0,this.Buffer=void 0,this._ls=void 0,this._es=void 0,this._handshakeState=void 0,this._readState=void 0,this._decryptedMsgs$=void 0,this._commandoMsgs$=void 0,this._partialCommandoMsgs=void 0,this._attemptedReconnects=void 0,this._logger=void 0,this._attemptReconnect=void 0,this._messageBuffer=void 0,this._processingBuffer=void 0,this._l=void 0,function(t){var e=t.remoteNodePublicKey,n=t.wsProxy,i=t.privateKey,o=t.ip,s=t.port,h=t.logger;if(!e||!a.default.publicKeyVerify(r.Buffer.from(e,"hex")))throw new Error(e+" is not a valid public key");if(!o||!o.match(/^((25[0-5]|(2[0-4]|1\d|[1-9]|)\d)(\.(?!$)|$)){4}$/))throw new Error(o+" is not a valid IP address");if(!s||s<1||s>65535)throw new Error(s+" is not a valid port number");if(n){var u=n+" is not a valid url";try{var f=new URL(n);if("wss:"!==f.protocol&&"ws:"!==f.protocol)throw new Error(u)}catch(t){throw new Error(u)}}if(i&&!R(i))throw new Error(i+" is not a valid private key");if(h){if("object"!=typeof h)throw new Error("Logger must be of type object");var c=["info","warn","error"];Object.entries(h).forEach(function(t){var e=t[0],r=t[1];if(!c.includes(e))throw new Error("Invalid logger level: "+e);if("function"!=typeof r)throw new Error("Logger for level: "+e+" is not a function")})}}(n);var o=n.remoteNodePublicKey,s=n.wsProxy,h=n.ip,u=n.port,c=void 0===u?9735:u,d=n.logger;this._ls=r.Buffer.from(n.privateKey||E(),"hex"),this._es=r.Buffer.from(E(),"hex"),this.noise=new A({ls:this._ls,es:this._es}),this.remoteNodePublicKey=o,this.publicKey=this.noise.lpk.toString("hex"),this.privateKey=this._ls.toString("hex"),this.wsUrl=s?s+"/"+h+":"+c:"wss://"+o+"@"+h+":"+c,this.connected$=new t.BehaviorSubject(!1),this.connecting=!1,this.Buffer=r.Buffer,this._handshakeState=k.INITIATOR_INITIATING,this._decryptedMsgs$=new t.Subject,this.decryptedMsgs$=this._decryptedMsgs$.asObservable(),this._commandoMsgs$=new t.Subject,this.commandoMsgs$=this._commandoMsgs$.asObservable().pipe(e.map(function(t){return f({},t.response,{reqId:t.id})})),this._partialCommandoMsgs={},this._attemptedReconnects=0,this._logger=d,this._readState=P.READY_FOR_LEN,this._processingBuffer=!1,this._l=null,this.decryptedMsgs$.subscribe(function(t){i.handleDecryptedMessage(t)})}var i=n.prototype;return i.connect=function(n){void 0===n&&(n=!0);try{var i=this;return i.connected$.getValue()?Promise.resolve(!0):(i.connecting=!0,i._log("info","Initiating connection to node "+i.remoteNodePublicKey),i._attemptReconnect=n,i._attemptedReconnects+=1,i.socket=new WebSocket(i.wsUrl),i.socket.binaryType="arraybuffer",i.socket.onopen=function(){try{return i._log("info","WebSocket is connected"),i._log("info","Creating Act1 message"),Promise.resolve(i.noise.initiatorAct1(r.Buffer.from(i.remoteNodePublicKey,"hex"))).then(function(t){i.socket&&(i._log("info","Sending Act1 message"),i.socket.send(t),i._handshakeState=k.AWAITING_RESPONDER_REPLY)})}catch(t){return Promise.reject(t)}},i.socket.onclose=function(){try{i._log("error","WebSocket is closed"),i._log("info","Attempted reconnects: "+i._attemptedReconnects),i.connected$.next(!1);var t=function(){if(i._attemptReconnect&&i._attemptedReconnects<5)return i.connecting=!0,i._log("info","Waiting to reconnect"),Promise.resolve(new Promise(function(t){return setTimeout(t,1e3*(i._attemptedReconnects||1))})).then(function(){i.connect()})}();return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(t){return Promise.reject(t)}},i.socket.onerror=function(t){i._log("error","WebSocket error: "+JSON.stringify(t))},i.socket.onmessage=i.queueMessage.bind(i),Promise.resolve(t.firstValueFrom(i.connected$.pipe(e.skip(1)))))}catch(t){return Promise.reject(t)}},i.queueMessage=function(t){var e=r.Buffer.from(t.data),n=this._messageBuffer&&!this._messageBuffer.eof&&this._messageBuffer.readBytes();this._messageBuffer=new S(n?r.Buffer.concat([n,e]):e),this._processingBuffer||(this._processingBuffer=!0,this._processBuffer())},i.disconnect=function(){this._log("info","Manually disconnecting from WebSocket"),this.noise=new A({ls:this._ls,es:this._es}),this._attemptReconnect=!1,this.socket&&this.socket.close()},i._processBuffer=function(){try{var t=function(t){if(_interrupt3)return t;e._processingBuffer=!1},e=this,r=z(function(){var t=!0;return function(t,e){var r;do{var n=t();if(n&&n.then){if(!K(n)){r=!0;break}n=n.v}var i=e();if(K(i)&&(i=i.v),!i)return n}while(!i.then);const o=new D,s=O.bind(null,o,2);return(r?n.then(a):i.then(h)).then(void 0,s),o;function a(r){for(n=r;K(i=e())&&(i=i.v),i;){if(i.then)return void i.then(h).then(void 0,s);if((n=t())&&n.then){if(!K(n))return void n.then(a).then(void 0,s);n=n.v}}O(o,1,n)}function h(r){if(r){do{if((n=t())&&n.then){if(!K(n))return void n.then(a).then(void 0,s);n=n.v}if(K(r=e())&&(r=r.v),!r)return void O(o,1,n)}while(!r.then);r.then(h).then(void 0,s)}else O(o,1,n)}}(function(){return e._handshakeState!==k.READY?j(e._handshakeState,[[function(){return k.INITIATOR_INITIATING},function(){throw new Error("Received data before intialised")}],[function(){return k.AWAITING_RESPONDER_REPLY},function(){return Promise.resolve(e._processResponderReply()).then(function(e){t=e})}]]):j(e._readState,[[function(){return P.READY_FOR_LEN},function(){return Promise.resolve(e._processPacketLength()).then(function(e){t=e})}],[function(){return P.READY_FOR_BODY},function(){return Promise.resolve(e._processPacketBody()).then(function(e){t=e})}],[function(){return P.BLOCKED},function(){t=!1}],[void 0,function(){throw new Error("Unknown read state")}]])},function(){return!_interrupt3&&!!t})},function(){e.disconnect()});return Promise.resolve(r&&r.then?r.then(t):t(r))}catch(t){return Promise.reject(t)}},i._processResponderReply=function(){try{var t=this,e=t._messageBuffer.readBytes(50);if(50!==e.byteLength)throw new Error("Invalid message received from remote node");return t._log("info","Validating message as part of Act2"),Promise.resolve(t.noise.initiatorAct2(e)).then(function(){return t._log("info","Creating reply for Act3"),Promise.resolve(t.noise.initiatorAct3()).then(function(e){return t.socket&&(t._log("info","Sending reply for act3"),t.socket.send(e),t._handshakeState=k.READY),!0})})}catch(t){return Promise.reject(t)}},i._processPacketLength=function(){var t=this;return Promise.resolve(z(function(){var e=t._messageBuffer.readBytes(18);return!!e&&Promise.resolve(t.noise.decryptLength(e)).then(function(e){return t._l=e,t._readState=P.READY_FOR_BODY,!0})},function(){return!1}))},i._processPacketBody=function(){try{var t=this;return Promise.resolve(!!t._l&&z(function(){var e=t._messageBuffer.readBytes(t._l+16);return!!e&&Promise.resolve(t.noise.decryptMessage(e)).then(function(e){return t._l=null,t._decryptedMsgs$.next(e),t._readState=P.READY_FOR_LEN,!0})},function(){return!1}))}catch(t){return Promise.reject(t)}},i.handleDecryptedMessage=function(t){try{var e=this;return Promise.resolve(z(function(){var n=new S(t),i=n.readUInt16BE(),o=(Object.entries(U).find(function(t){return t[1]===i})||[])[0],s=n.readBytes(8).toString("hex"),a=n.readBytes();if(e._log("info","Message type is: "+(o||"unknown")),i===U.CommandoResponseContinues)return e._log("info","Received a partial commando message, caching it to join with other parts"),void(e._partialCommandoMsgs[s]=e._partialCommandoMsgs[s]?r.Buffer.concat([e._partialCommandoMsgs[s],a.subarray(0,a.byteLength-16)]):t.subarray(0,t.length-16));i===U.CommandoResponse&&e._partialCommandoMsgs[s]&&(e._log("info","Received a final commando msg and we have a partial message to join it to. Joining now"),t=r.Buffer.concat([e._partialCommandoMsgs[s],a]),delete e._partialCommandoMsgs[s]),e._log("info","Deserialising payload");var h=function(t){var e=t.readUInt16BE(0);switch(e){case U.Init:return C.deserialize(t);case U.Ping:return T.deserialize(t);case U.Pong:return x.deserialize(t);case U.CommandoResponse:case U.CommandoResponseContinues:return M.deserialize(t)}return{type:e}}(t),u=j(h.type,[[function(){return U.Init},function(){return e._log("info","Constructing Init message reply"),Promise.resolve(e.noise.encryptMessage(h.serialize())).then(function(t){e.socket&&(e._log("info","Sending Init message reply"),e.socket.send(t),e._log("info","Connected and ready to send messages!"),e.connected$.next(!0),e.connecting=!1,e._attemptedReconnects=0)})}],[function(){return U.Ping},function(){e._log("info","Received a Ping message"),e._log("info","Creating a Pong message");var t=new x(h.numPongBytes).serialize();return Promise.resolve(e.noise.encryptMessage(t)).then(function(t){e.socket&&(e._log("info","Sending a Pong message"),e.socket.send(t))})}],[function(){return U.CommandoResponse},function(){e._commandoMsgs$.next(h)},function(){}]]);return u&&u.then?u.then(function(){}):void 0},function(t){e._log("error","Error handling incoming message: "+t.message)}))}catch(t){return Promise.reject(t)}},i.commando=function(n){var i=n.method,o=n.params,s=void 0===o?[]:o,a=n.rune,h=n.reqId;try{var u=function(){var n=new L;if(!h){var o=r.Buffer.allocUnsafe(8),u=window.crypto.getRandomValues(o);h=u.toString("hex")}return n.writeUInt16BE(U.CommandoRequest),n.writeBytes(r.Buffer.from(h,"hex")),n.writeBytes(r.Buffer.from(JSON.stringify({rune:a,method:i,params:s}))),f._log("info","Creating message to send"),Promise.resolve(f.noise.encryptMessage(n.toBuffer())).then(function(r){if(f.socket)return f._log("info","Sending commando message"),f.socket.send(r),f._log("info","Message sent and awaiting response"),Promise.resolve(t.firstValueFrom(f._commandoMsgs$.pipe(e.filter(function(t){return t.id===h})))).then(function(t){var e=t.response,r=e.result,n=e.error;if(f._log("info",r?"Successful response received":"Error response received: "+n.message),n)throw n;return r});throw new Error("No socket initialised and connected")})},f=this;f._log("info","Commando request method: "+i+" params: "+JSON.stringify(s));var c=f.connected$.getValue()||f.connecting?(f._log("info","Ensuring we have a connection before making request"),Promise.resolve(t.firstValueFrom(f.connected$.pipe(e.filter(function(t){return!0===t})))).then(function(){})):(f._log("info","No socket connection, so creating one now"),Promise.resolve(f.connect()).then(function(){}));return Promise.resolve(c&&c.then?c.then(u):u())}catch(t){return Promise.reject(t)}},i._log=function(t,e){this._logger&&this._logger[t]&&this._logger[t]("["+t.toUpperCase()+" - "+(new Date).toLocaleTimeString()+"]: "+e)},n}()});
//# sourceMappingURL=index.umd.js.map
